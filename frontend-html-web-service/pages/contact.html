<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tax2Ready - Contact</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Mali:wght@400;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="../assets/TD_web_icon.png">
    <script src="../config.js"></script>
    <style>
        .font-mali {
            font-family: 'Mali', sans-serif;
        }
    </style>
</head>
<body class="font-mali flex items-center justify-center min-h-screen bg-[#c4bcac]">

<!-- Header -->
<header class="bg-[#b49c74] shadow-md w-full py-4 px-6 fixed top-0 left-0">
    <div class="max-w-6xl mx-auto flex justify-between items-center">
        <!-- โลโก้ / ชื่อเว็บ -->
        <h1 class="text-2xl text-[#4e342e] font-bold font-mali justify-start">Tax2Ready</h1>

        <!-- เมนูหลัก (Desktop) -->
        <nav class="hidden md:flex space-x-6 relative">
            <a href="account.html" class="text-[#f7efda] font-mali hover:text-[#4e342e] hover:underline">บัญชีผู้ใช้</a>
            <a href="home.html" class="text-[#f7efda] font-mali hover:text-[#4e342e] hover:underline">เริ่มต้นเรียนรู้ใหม่</a>

            <!-- Dropdown for 'เรียนรู้เพิ่มเติม' -->
            <div class="relative group">
                <button id="learn-more-btn"
                        class="text-[#f7efda] font-mali hover:text-[#4e342e] hover:underline focus:outline-none">
                    เรียนรู้เพิ่มเติม
                </button>
                <div id="learn-more-menu" class="absolute hidden bg-[#b49c74] mt-2 w-60 rounded-lg shadow-lg z-10 p-2">
                    <ul>
                        <li><a href="1tax-intro.html"
                               class="font-mali block px-4 py-2 text-[#f7efda] hover:bg-[#8d6e63] hover:underline">1.
                            ภาษีคืออะไร?</a></li>
                        <li><a href="2why-pay-tax.html"
                               class="font-mali block px-4 py-2 text-[#f7efda] hover:bg-[#8d6e63] hover:underline">2.
                            ทำไมเราต้องจ่ายภาษี?</a></li>
                        <li><a href="3no-tax-consequence.html"
                               class="font-mali block px-4 py-2 text-[#f7efda] hover:bg-[#8d6e63] hover:underline">3.
                            ไม่จ่ายภาษีจะเกิดอะไรขึ้น?</a></li>
                        <li><a href="4who-pays-tax.html"
                               class="font-mali block px-4 py-2 text-[#f7efda] hover:bg-[#8d6e63] hover:underline">4.
                            ใครบ้างที่ต้องเริ่มจ่ายภาษี?</a></li>
                        <li><a href="5income-tax.html"
                               class="font-mali block px-4 py-2 text-[#f7efda] hover:bg-[#8d6e63] hover:underline">5.
                            รายได้ที่ต้องเสียภาษี?</a></li>
                        <li><a href="6tax-deductions.html"
                               class="font-mali block px-4 py-2 text-[#f7efda] hover:bg-[#8d6e63] hover:underline">6.
                            สิทธิ์ลดหย่อนภาษี?</a></li>
                        <li><a href="7tax-frequency.html"
                               class="font-mali block px-4 py-2 text-[#f7efda] hover:bg-[#8d6e63] hover:underline">7.
                            ต้องจ่ายภาษีบ่อยแค่ไหน?</a></li>
                        <li><a href="8how-to-pay-tax.html"
                               class="font-mali block px-4 py-2 text-[#f7efda] hover:bg-[#8d6e63] hover:underline">8.
                            มีวิธีจ่ายภาษีอย่างไร?</a></li>
                    </ul>
                </div>
            </div>

            <a href="tax-personal.html"
               class="text-[#f7efda] font-mali hover:text-[#4e342e] hover:underline">คำนวณภาษี</a>
            <a href="contact.html"
               class="text-[#f7efda] font-mali hover:text-[#4e342e] hover:underline">ติดต่อ</a>
        </nav>


        <!-- ปุ่ม Login (Desktop) -->
        <button type="button" onclick="location.href='sign-in-up.html'"
                class="loginButton opacity-100 hidden md:block bg-[#4e342e] text-white font-mali px-4 py-2 rounded-lg hover:bg-[#8d6e63]">
            Login
        </button>

        <!-- เมนูมือถือ (Hamburger Icon) -->
        <button class="md:hidden text-gray-600" id="mobile-menu-button">
            ☰
        </button>
    </div>

    <!-- เมนูสำหรับมือถือ (ซ่อนอยู่) -->
    <nav id="mobile-menu" class="hidden md:hidden flex flex-col space-y-2 mt-3 bg-[#b49c74] p-4">
        <a href="account.html"
           class="text-[#f7efda] font-mali hover:text-[#4e342e] hover:underline">บัญชีผู้ใช้</a>
        <a href="home.html"
           class="text-[#f7efda] font-mali hover:text-[#4e342e] hover:underline">เริ่มต้นเรียนรู้ใหม่</a>

        <a href="#" id="learn-more-btn-mobile" class="text-[#f7efda] font-mali hover:text-[#4e342e] hover:underline">เรียนรู้เพิ่มเติม</a>
        <ul id="learn-more-menu-mobile" class="hidden flex-col space-y-2 bg-[#b49c74] p-2 rounded-lg">
            <li><a href="1tax-intro.html"
                   class="font-mali block px-4 py-2 text-[#f7efda] hover:bg-[#8d6e63] hover:underline">1.
                ภาษีคืออะไร?</a></li>
            <li><a href="2why-pay-tax.html"
                   class="font-mali block px-4 py-2 text-[#f7efda] hover:bg-[#8d6e63] hover:underline">2.
                ทำไมเราต้องจ่ายภาษี?</a></li>
            <li><a href="3no-tax-consequence.html"
                   class="font-mali block px-4 py-2 text-[#f7efda] hover:bg-[#8d6e63] hover:underline">3.
                ไม่จ่ายภาษีจะเกิดอะไรขึ้น?</a></li>
            <li><a href="4who-pays-tax.html"
                   class="font-mali block px-4 py-2 text-[#f7efda] hover:bg-[#8d6e63] hover:underline">4.
                ใครบ้างที่ต้องเริ่มจ่ายภาษี?</a></li>
            <li><a href="5income-tax.html"
                   class="font-mali block px-4 py-2 text-[#f7efda] hover:bg-[#8d6e63] hover:underline">5.
                รายได้ที่ต้องเสียภาษี?</a></li>
            <li><a href="6tax-deductions.html"
                   class="font-mali block px-4 py-2 text-[#f7efda] hover:bg-[#8d6e63] hover:underline">6.
                สิทธิ์ลดหย่อนภาษี?</a></li>
            <li><a href="7tax-frequency.html"
                   class="font-mali block px-4 py-2 text-[#f7efda] hover:bg-[#8d6e63] hover:underline">7.
                ต้องจ่ายภาษีบ่อยแค่ไหน?</a></li>
            <li><a href="8how-to-pay-tax.html"
                   class="font-mali block px-4 py-2 text-[#f7efda] hover:bg-[#8d6e63] hover:underline">8.
                มีวิธีจ่ายภาษีอย่างไร?</a></li>
        </ul>
        <a href="tax-personal.html"
           class="text-[#f7efda] font-mali hover:text-[#4e342e] hover:underline">คำนวณภาษี</a>
        <a href="contact.html" class="text-[#f7efda] font-mali hover:text-[#4e342e] hover:underline">ติดต่อ</a>

        <button type="button" onclick="location.href='sign-in-up.html'"
                class="loginButton opacity-100 bg-[#4e342e] text-white font-mali px-4 py-2 rounded-lg hover:bg-[#8d6e63]">
            Login
        </button>
    </nav>
</header>

<!-- Main Content -->
<div id="main-container"
     class="w-full max-w-sm md:max-w-[1100px] h-auto md:h-[600px] p-6 flex flex-col md:flex-row justify-center items-center text-center border border-gray-300 shadow-lg rounded-xl bg-[#ece4d4] mt-20">
    <div class="flex flex-col md:flex-row gap-10 w-full justify-center items-start">
        <!-- Profile Information -->
        <div class="w-full md:w-1/2 space-y-4">
            <div class="bg-white p-4 rounded-lg shadow-md flex items-center gap-8">
                <img src="../assets/tipsukanya.jpg" alt="ทิพสุกัญญา นรสิงห์" class="w-20 h-20 rounded-lg">
                <div>
                    <p class="text-lg font-bold">ทิพสุกัญญา นรสิงห์</p>
                </div>
            </div>

            <div class="bg-white p-4 rounded-lg shadow-md flex items-center gap-8">
                <img src="../assets/chatchada.jpg" alt="ชัชชฎา เดชครุฑ" class="w-20 h-20 rounded-lg">
                <div>
                    <p class="text-lg font-bold">ชัชชฎา เดชครุฑ</p>
                </div>
            </div>

            <div class="bg-white p-4 rounded-lg shadow-md flex items-center gap-8">
                <img src="../assets/Logo_ku.png" alt="มหาวิทยาลัยเกษตรศาสตร์" class="w-20 h-20 rounded-lg">
                <div>
                    <p class="text-lg font-bold">มหาวิทยาลัยเกษตรศาสตร์</p>
                    <p class="text-sm text-gray-600">คณะวิทยาศาสตร์ วิทยาการคอมพิวเตอร์</p>
                    <p class="text-sm text-gray-600">อาจารย์ พรรณภัทร์ จันทรไพแสง</p>
                </div>
            </div>

            <!-- Rating Section -->
            <div class="bg-white p-4 rounded-lg shadow-md text-center">
                <p class="text-2xl font-bold">ให้คะแนนเรา</p>
                <div class="flex justify-center mt-2 space-x-2" id="star-rating">
                    <span class="text-gray-400 text-5xl cursor-pointer" data-rate="1">★</span>
                    <span class="text-gray-400 text-5xl cursor-pointer" data-rate="2">★</span>
                    <span class="text-gray-400 text-5xl cursor-pointer" data-rate="3">★</span>
                    <span class="text-gray-400 text-5xl cursor-pointer" data-rate="4">★</span>
                    <span class="text-gray-400 text-5xl cursor-pointer" data-rate="5">★</span>
                </div>
                <p class="text-lg mt-2">รบกวนให้คะแนนระบบของเรา</p>
            </div>
        </div>

        <!-- Contact Form -->
        <div class="w-full md:w-1/2 h-auto md:h-[550px] bg-white p-6 rounded-lg shadow-md flex flex-col justify-between">
            <h2 class="text-xl font-bold mb-4">ติดต่อเรา</h2>
            <form id="contact-form">
                <!-- ชื่อของคุณ -->
                <div class="mb-4">
                    <label class="block text-gray-700 text-start">ชื่อของคุณ</label>
                    <input
                            type="text"
                            id="input-name"
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-[#4e342e]"
                            required
                            pattern="^[A-Za-zก-๙\s]+$"
                    >
                </div>

                <!-- เบอร์โทร -->
                <div class="mb-4 gap-4">
                    <label class="block text-gray-700 text-start">เบอร์โทร</label>
                    <input
                            type="text"
                            id="input-phone"
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-[#4e342e]"
                            required
                            pattern="^[0-9]{10}$"
                    >
                </div>

                <!-- อีเมลของคุณ -->
                <div class="mb-4 gap-4">
                    <label class="block text-gray-700 text-start">อีเมลของคุณ</label>
                    <input
                            type="email"
                            id="input-email"
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-[#4e342e]"
                            required
                    >
                </div>

                <!-- เรื่องที่ต้องการติดต่อ -->
                <div class="mb-4 gap-4">
                    <label class="block text-gray-700 text-start">เรื่องที่ต้องการติดต่อ</label>
                    <textarea
                            id="input-message"
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-[#4e342e]"
                            rows="4"
                            required
                    ></textarea>
                </div>
            </form>

            <!-- ปุ่มเปิดป๊อปอัพ -->
            <div class="flex justify-center">
                <button id="openPopup" type="button"
                        class="bg-[#4e342e] text-white py-2 px-4 rounded-lg hover:bg-[#8d6e63]">
                    ยืนยัน
                </button>
            </div>

            <!-- ป๊อปอัพ -->
            <div id="popup" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden">
                <div class="bg-white p-6 rounded-lg shadow-lg w-96 text-center">
                    <h2 class="text-xl font-bold mb-4">ยืนยันการดำเนินการ</h2>
                    <p class="mb-4">คุณแน่ใจหรือไม่ว่าต้องการดำเนินการนี้?</p>
                    <div class="flex justify-center space-x-4">
                        <button id="confirm" type="button"
                                class="bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600">
                            ยืนยัน
                        </button>
                        <button id="cancel" type="button"
                                class="bg-red-500 text-white py-2 px-4 rounded-lg hover:bg-red-600">
                            ยกเลิก
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript สำหรับควบคุมเมนู, ป๊อปอัพ, และการให้คะแนน -->
<script>
    // =========================== เมนูมือถือ (ถ้ามี) ===========================
    document.getElementById("mobile-menu-button").addEventListener("click", function () {
        document.getElementById("mobile-menu").classList.toggle("hidden");
    });

    // =========================== Dropdown เรียนรู้เพิ่มเติม (ถ้ามี) =========================
    document.getElementById("learn-more-btn").addEventListener("click", function () {
        document.getElementById("learn-more-menu").classList.toggle("hidden");
    });

    document.getElementById("learn-more-btn-mobile").addEventListener("click", function () {
        document.getElementById("learn-more-menu-mobile").classList.toggle("hidden");
    });

    // =========================== การให้คะแนนดาว ===========================
    document.querySelectorAll("#star-rating span").forEach(star => {
        star.addEventListener("click", function () {
            const rating = parseInt(this.getAttribute("data-rate"));
            document.querySelectorAll("#star-rating span").forEach(s => {
                const starRating = parseInt(s.getAttribute("data-rate"));
                s.style.color = starRating <= rating ? "gold" : "gray";
            });
        });
    });

    // =========================== ป๊อปอัพยืนยันการส่งฟอร์ม ===========================
    // ปุ่ม "ยืนยัน" ที่เปิดป๊อปอัพ
    document.getElementById("openPopup").addEventListener("click", function () {
        const form = document.querySelector("form"); // หรือ document.getElementById("contact-form")
        if (!form.checkValidity()) {
            form.reportValidity();
            return;
        }
        document.getElementById("popup").classList.remove("hidden");
    });

    // ปุ่มยกเลิกป๊อปอัพ
    document.getElementById("cancel").addEventListener("click", function (event) {
        event.preventDefault();
        document.getElementById("popup").classList.add("hidden");
    });

    // ปุ่มยืนยันในป๊อปอัพ => ส่งข้อมูลไป /contact/save
    document.getElementById("confirm").addEventListener("click", async function (event) {
        event.preventDefault();

        // ดึงข้อมูลจากฟอร์ม
        const name = document.getElementById('input-name').value.trim();
        const phone = document.getElementById('input-phone').value.trim();
        const email = document.getElementById('input-email').value.trim();
        const message = document.getElementById('input-message').value.trim();

        // ส่งข้อมูลไปยังเซิร์ฟเวอร์
        try {
            const response = await fetch('/contact/saveContact', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name, phone, email, message })
            });
            if (response.ok) {
                alert('ส่งข้อมูลติดต่อเรียบร้อยแล้ว');
                document.querySelector("form").reset(); // ล้างฟอร์ม
            } else {
                const errorData = await response.json();
                alert(`เกิดข้อผิดพลาด: ${errorData.error}`);
            }
        } catch (error) {
            console.error('Error submitting contact:', error);
            alert('เกิดข้อผิดพลาดในการส่งข้อมูล');
        }

        // ปิดป๊อปอัพ
        document.getElementById("popup").classList.add("hidden");
    });

    // =========================== ซ่อนปุ่ม Login ถ้า token ยัง valid ===========================
    document.addEventListener("DOMContentLoaded", function () {
        const token = 'Bearer ' + localStorage.getItem('jwt_token');
        fetch('/users/is-valid', {
            method: 'GET',
            headers: { 'Authorization': token }
        })
            .then(response => {
                document.querySelectorAll('.loginButton').forEach(button => {
                    if (response.status === 200) {
                        // token valid => ซ่อนปุ่ม
                        button.classList.add('opacity-0', 'pointer-events-none');
                        button.classList.remove('opacity-100');
                    } else {
                        // token invalid => แสดงปุ่ม
                        button.classList.remove('opacity-0', 'pointer-events-none');
                        button.classList.add('opacity-100');
                    }
                });
            })
            .catch(error => {
                console.error('Error:', error);
                // ถ้าเกิด error ก็ให้แสดงปุ่มไว้ก่อน
                document.querySelectorAll('.loginButton').forEach(button => {
                    button.classList.remove('opacity-0', 'pointer-events-none');
                    button.classList.add('opacity-100');
                });
            });
    });
</script>
</body>
</html>
