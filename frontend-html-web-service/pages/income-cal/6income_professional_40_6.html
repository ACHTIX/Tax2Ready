<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>Independent Professional Fees (Section 40(6))</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Mali -->
    <link
            href="https://fonts.googleapis.com/css2?family=Mali:wght@400;700&display=swap"
            rel="stylesheet"
    />
    <style>
        .font-mali {
            font-family: 'Mali', sans-serif;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen bg-[#c4bcac] font-mali">

<!-- Header -->
<header class="bg-[#b49c74] shadow-md w-full py-4 px-6 fixed top-0 left-0">
    <div class="max-w-6xl mx-auto flex justify-between items-center">
        <h1 class="text-2xl text-[#4e342e] font-bold font-mali">
            Tax2Ready
        </h1>
        <nav class="hidden md:flex space-x-6">
            <a
                    href="../tax-calculator.html"
                    class="bg-[#4e342e] text-white px-4 py-2 rounded-lg hover:bg-[#8d6e63]"
            >
                ย้อนกลับ
            </a>
        </nav>
    </div>
</header>

<!-- Main Container -->
<div
        id="main-container"
        class="w-full max-w-sm md:max-w-[1100px] h-auto md:h-[600px] p-6 flex flex-col md:flex-row justify-center items-center text-center border border-gray-300 shadow-lg rounded-xl bg-[#ece4d4] mt-20">
    <div class="flex flex-col md:flex-row gap-10 w-full justify-center items-start">
        <!-- Content Box -->
        <div class="w-full h-auto md:h-[550px] bg-white p-6 rounded-lg shadow-md gap-6 flex flex-col justify-start items-start overflow-auto">

            <!-- Container สำหรับรายการ -->
            <div id="itemContainer" class="flex flex-col w-full gap-6">
                <!-- กล่องรายการแรก (ห้ามลบ) -->
                <div class="border border-gray-300 rounded-lg p-4 relative">
                    <div class="mb-2 font-bold text-2xl text-center">
                        ค่าตอบแทนวิชาชีพอิสระ
                    </div>

                    <!-- ประเภทธุรกิจ -->
                    <div class="mb-3 text-left">
                        <label
                                class="block mb-1 text-[#4e342e]"
                                for="businessType1"
                        >
                            ประเภทธุรกิจ:
                        </label>
                        <select
                                id="businessType1"
                                name="businessType1"
                                class="w-full border border-gray-300 rounded p-2"
                        >
                            <option value="">เลือกประเภทของเงินได้</option>
                            <option value="วิชากฎหมาย">วิชากฎหมาย</option>
                            <option value="การประกอบโรคศิลปะ">การประกอบโรคศิลปะ</option>
                            <option value="วิศวกรรม">วิศวกรรม</option>
                            <option value="สถาปัตยกรรม">สถาปัตยกรรม</option>
                            <option value="การบัญชี">การบัญชี</option>
                            <option value="ประณีตศิลปกรรม">ประณีตศิลปกรรม</option>
                        </select>
                    </div>

                    <!-- เงินได้ทั้งหมด -->
                    <div class="mb-3 text-left">
                        <label
                                class="block mb-1 text-[#4e342e]"
                                for="totalIncome1"
                        >
                            เงินได้ทั้งหมด:
                        </label>
                        <input
                                type="number"
                                id="totalIncome1"
                                name="totalIncome1"
                                placeholder="ระบุจำนวนเงิน"
                                class="w-full border border-gray-300 rounded p-2"
                        />
                    </div>

                    <!-- ภาษีหัก ณ ที่จ่าย -->
                    <div class="mb-3 text-left">
                        <label
                                class="block mb-1 text-[#4e342e]"
                                for="taxWithheld1"
                        >
                            ภาษีหัก ณ ที่จ่าย:
                        </label>
                        <input
                                type="number"
                                id="taxWithheld1"
                                name="taxWithheld1"
                                placeholder="หากไม่มีให้ใส่ 0"
                                class="w-full border border-gray-300 rounded p-2"
                        />
                    </div>

                    <!-- เลขผู้จ่ายเงินได้ -->
                    <div class="mb-3 text-left">
                        <label
                                class="block mb-1 text-[#4e342e]"
                                for="payerNumber1"
                        >
                            เลขผู้จ่ายเงินได้:
                        </label>
                        <input
                                type="text"
                                id="payerNumber1"
                                name="payerNumber1"
                                placeholder="ระบุเลขผู้จ่าย"
                                class="w-full border border-gray-300 rounded p-2"
                        />
                    </div>

                    <!-- วิธีการหักค่าใช้จ่าย -->
                    <div class="mb-3 text-left">
              <span class="block mb-1 text-[#4e342e]">
                วิธีการหักค่าใช้จ่าย:
              </span>
                        <div class="flex items-center gap-4">
                            <div>
                                <input
                                        type="radio"
                                        id="deductTypeLump1"
                                        name="deductType1"
                                        value="lumpSum"
                                        checked
                                />
                                <label for="deductTypeLump1">หักแบบเหมา - (%)</label>
                            </div>
                            <div>
                                <input
                                        type="radio"
                                        id="deductTypeActual1"
                                        name="deductType1"
                                        value="actual"
                                />
                                <label for="deductTypeActual1">หักตามค่าใช้จ่ายจริง</label>
                            </div>
                        </div>
                        <!-- หมายเหตุ -->
                        <div class="mt-2 ml-4">
                            <div id="lumpSumNote1" class="text-sm text-gray-600">
                                - ไม่ต้องใส่เป็นจำนวนบาท<br/>
                                - ไม่มีเลขหลังทศนิยม
                            </div>
                            <div
                                    id="actualNote1"
                                    class="text-sm text-gray-600 hidden"
                            >
                                - ต้องแนบหลักฐานค่าใช้จ่าย
                            </div>
                        </div>
                    </div>

                    <!-- ระบุ -->
                    <div class="mb-3 text-left">
                        <label
                                class="block mb-1 text-[#4e342e]"
                                for="remark1"
                        >
                            ระบุ:
                        </label>
                        <input
                                type="text"
                                id="remark1"
                                name="remark1"
                                placeholder="ระบุรายละเอียดเพิ่มเติม (ถ้ามี)"
                                class="w-full border border-gray-300 rounded p-2"
                        />
                    </div>
                </div>
            </div>

            <!-- ปุ่มเพิ่มรายการอื่น -->
            <button
                    id="addItemBtn"
                    class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg self-center"
            >
                + เพิ่มรายการอื่น
            </button>

            <!-- ปุ่มบันทึกข้อมูลทั้งหมด -->
            <button id="saveButton" class="w-full mt-4 px-4 py-2 bg-[#4e342e] text-white rounded-lg shadow">
                บันทึก
            </button>

            <!-- Modal แจ้งเตือน สำหรับการยืนยันการบันทึกข้อมูล -->
            <div id="saveModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden">
                <div class="bg-white rounded-lg shadow-lg p-6 w-[350px] text-center">
                    <p class="text-lg text-gray-800 font-semibold">คุณต้องการบันทึกข้อมูลทั้งหมดหรือไม่?</p>
                    <div class="flex justify-center gap-4 mt-4">
                        <button id="cancelSave" class="px-4 py-2 bg-gray-400 text-white rounded-lg shadow">
                            ยกเลิก
                        </button>
                        <button id="confirmSave" class="px-4 py-2 bg-green-500 text-white rounded-lg shadow">
                            บันทึก
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Script ส่วนการทำงาน -->
<script>
    // เมื่อกดปุ่ม "บันทึก" สำหรับข้อมูลทั้งหมด
    document.getElementById("saveButton").addEventListener("click", function () {
        document.getElementById("saveModal").classList.remove("hidden");
    });

    // ยืนยันการบันทึกข้อมูลทั้งหมดและเปลี่ยนหน้าไปยัง tax-calculator.html
    document.getElementById("confirmSave").addEventListener("click", function () {
        window.location.href = "../tax-calculator.html";
    });

    const addItemBtn = document.getElementById('addItemBtn');
    const itemContainer = document.getElementById('itemContainer');

    // ตัวแปรนับจำนวนรายการ
    let itemCount = 1;

    // ฟังก์ชันสลับแสดง/ซ่อนข้อความหมายเหตุ (สำหรับหักแบบเหมา vs หักตามจริง)
    function toggleDeductNote(radioLump, noteLump, noteActual) {
        radioLump.forEach(radio => {
            radio.addEventListener('change', () => {
                if (radio.value === 'lumpSum' && radio.checked) {
                    noteLump.classList.remove('hidden');
                    noteActual.classList.add('hidden');
                } else {
                    noteLump.classList.add('hidden');
                    noteActual.classList.remove('hidden');
                }
            });
        });
    }

    // กำหนด event แสดง/ซ่อนหมายเหตุ สำหรับรายการแรก (เริ่มต้น)
    const radiosFirst = [
        document.getElementById('deductTypeLump1'),
        document.getElementById('deductTypeActual1')
    ];
    const lumpSumNoteFirst = document.getElementById('lumpSumNote1');
    const actualNoteFirst = document.getElementById('actualNote1');
    toggleDeductNote(radiosFirst, lumpSumNoteFirst, actualNoteFirst);

    addItemBtn.addEventListener('click', () => {
        itemCount++;

        // สร้าง container สำหรับรายการใหม่
        const newItem = document.createElement('div');
        newItem.className = 'border border-gray-300 rounded-lg p-4 relative';

        // หัวข้อรายการ + ปุ่มลบ
        const headerDiv = document.createElement('div');
        headerDiv.className = 'mb-2 font-bold text-lg text-left text-[#4e342e] flex justify-between items-center';

        // ข้อความ "รายการที่ X"
        const headerText = document.createElement('span');
        headerText.textContent = `รายการที่ ${itemCount}`;
        headerDiv.appendChild(headerText);

        // ปุ่มลบ ❌
        const deleteBtn = document.createElement('button');
        deleteBtn.textContent = '❌';
        deleteBtn.className = 'text-white bg-red-500 hover:bg-red-600 px-2 py-1 rounded';
        deleteBtn.addEventListener('click', () => {
            itemContainer.removeChild(newItem);
        });
        headerDiv.appendChild(deleteBtn);

        // เพิ่มหัวข้อไปยัง newItem
        newItem.appendChild(headerDiv);

        // ประเภทธุรกิจ
        const businessTypeDiv = document.createElement('div');
        businessTypeDiv.className = 'mb-3 text-left';
        businessTypeDiv.innerHTML = `
        <label class="block mb-1 text-[#4e342e]" for="businessType${itemCount}">
          ประเภทธุรกิจ:
        </label>
        <select
          id="businessType${itemCount}"
          name="businessType${itemCount}"
          class="w-full border border-gray-300 rounded p-2"
        >
          <option value="">เลือกประเภทของเงินได้</option>
          <option value="ร้านอาหาร">ร้านอาหาร</option>
          <option value="ร้านกาแฟ">ร้านกาแฟ</option>
          <option value="ค้าปลีก">ค้าปลีก</option>
        </select>
      `;
        newItem.appendChild(businessTypeDiv);

        // เงินได้ทั้งหมด
        const totalIncomeDiv = document.createElement('div');
        totalIncomeDiv.className = 'mb-3 text-left';
        totalIncomeDiv.innerHTML = `
        <label class="block mb-1 text-[#4e342e]" for="totalIncome${itemCount}">
          เงินได้ทั้งหมด:
        </label>
        <input
          type="number"
          id="totalIncome${itemCount}"
          name="totalIncome${itemCount}"
          placeholder="ระบุจำนวนเงิน"
          class="w-full border border-gray-300 rounded p-2"
        />
      `;
        newItem.appendChild(totalIncomeDiv);

        // ภาษีหัก ณ ที่จ่าย
        const taxWithheldDiv = document.createElement('div');
        taxWithheldDiv.className = 'mb-3 text-left';
        taxWithheldDiv.innerHTML = `
        <label class="block mb-1 text-[#4e342e]" for="taxWithheld${itemCount}">
          ภาษีหัก ณ ที่จ่าย:
        </label>
        <input
          type="number"
          id="taxWithheld${itemCount}"
          name="taxWithheld${itemCount}"
          placeholder="หากไม่มีให้ใส่ 0"
          class="w-full border border-gray-300 rounded p-2"
        />
      `;
        newItem.appendChild(taxWithheldDiv);

        // เลขผู้จ่ายเงินได้
        const payerNumberDiv = document.createElement('div');
        payerNumberDiv.className = 'mb-3 text-left';
        payerNumberDiv.innerHTML = `
        <label class="block mb-1 text-[#4e342e]" for="payerNumber${itemCount}">
          เลขผู้จ่ายเงินได้:
        </label>
        <input
          type="text"
          id="payerNumber${itemCount}"
          name="payerNumber${itemCount}"
          placeholder="ระบุเลขผู้จ่าย"
          class="w-full border border-gray-300 rounded p-2"
        />
      `;
        newItem.appendChild(payerNumberDiv);

        // วิธีการหักค่าใช้จ่าย
        const deductTypeDiv = document.createElement('div');
        deductTypeDiv.className = 'mb-3 text-left';
        deductTypeDiv.innerHTML = `
        <span class="block mb-1 text-[#4e342e]">วิธีการหักค่าใช้จ่าย:</span>
        <div class="flex items-center gap-4">
          <div>
            <input
              type="radio"
              id="deductTypeLump${itemCount}"
              name="deductType${itemCount}"
              value="lumpSum"
              checked
            />
            <label for="deductTypeLump${itemCount}">หักแบบเหมา - (%)</label>
          </div>
          <div>
            <input
              type="radio"
              id="deductTypeActual${itemCount}"
              name="deductType${itemCount}"
              value="actual"
            />
            <label for="deductTypeActual${itemCount}">หักตามค่าใช้จ่ายจริง</label>
          </div>
        </div>
        <div class="mt-2 ml-4">
          <div id="lumpSumNote${itemCount}" class="text-sm text-gray-600">
            - ไม่ต้องใส่เป็นจำนวนบาท<br />
            - ไม่มีเลขหลังทศนิยม
          </div>
          <div
            id="actualNote${itemCount}"
            class="text-sm text-gray-600 hidden"
          >
            - ต้องแนบหลักฐานค่าใช้จ่าย
          </div>
        </div>
      `;
        newItem.appendChild(deductTypeDiv);

        // ระบุ
        const remarkDiv = document.createElement('div');
        remarkDiv.className = 'mb-3 text-left';
        remarkDiv.innerHTML = `
        <label class="block mb-1 text-[#4e342e]" for="remark${itemCount}">
          ระบุ:
        </label>
        <input
          type="text"
          id="remark${itemCount}"
          name="remark${itemCount}"
          placeholder="ระบุรายละเอียดเพิ่มเติม (ถ้ามี)"
          class="w-full border border-gray-300 rounded p-2"
        />
      `;
        newItem.appendChild(remarkDiv);

        // ใส่ newItem ลงใน itemContainer
        itemContainer.appendChild(newItem);

        // จัดการ event แสดง/ซ่อนหมายเหตุ (หักแบบเหมา / ตามจริง) สำหรับรายการใหม่
        const radios = [
            document.getElementById(`deductTypeLump${itemCount}`),
            document.getElementById(`deductTypeActual${itemCount}`)
        ];
        const lumpSumNote = document.getElementById(`lumpSumNote${itemCount}`);
        const actualNote = document.getElementById(`actualNote${itemCount}`);
        toggleDeductNote(radios, lumpSumNote, actualNote);
    });
</script>
</body>
</html>
